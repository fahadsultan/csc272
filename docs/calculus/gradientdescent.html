<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Gradient Descent</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../style.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../logo.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../calendar.html"> 
<span class="menu-text">Calendar</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-syllabus" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Syllabus</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-syllabus">    
        <li>
    <a class="dropdown-item" href="../syllabus/about.html">
 <span class="dropdown-text">Course Description and Goals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../syllabus/grading.html">
 <span class="dropdown-text">Grading</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../syllabus/academic_success.html">
 <span class="dropdown-text">Center for Academic Success</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../syllabus/textbook.html">
 <span class="dropdown-text">Textbooks &amp; Other Resources</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../syllabus/integrity.html">
 <span class="dropdown-text">Academic Integrity</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../syllabus/mental_health.html">
 <span class="dropdown-text">Mental Health Resources</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../syllabus/accomodations.html">
 <span class="dropdown-text">Accomodations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../syllabus/title_9.html">
 <span class="dropdown-text">Nondiscrimination Policy and Sexual Misconduct</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../project/project.html"> 
<span class="menu-text">Project</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../project/data.html"> 
<span class="menu-text">Datasets</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://courses.furman.edu/course/view.php?id=18728"> 
<span class="menu-text">Moodle Page</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus/appointment.html"> 
<span class="menu-text">Office Hours</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../ta.html"> 
<span class="menu-text">TA</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://calendly.com/ssultan-dpq/"> 
<span class="menu-text">Set an Appointment</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../calculus/calculus0.html">CALCULUS</a></li><li class="breadcrumb-item"><a href="../calculus/gradientdescent.html">Gradient Descent</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../pandas/linalg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LINEAR ALGEBRA</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../pandas/preliminaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preliminaries</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas/read_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reading Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas/view_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Index and Columns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas/write_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Writing Data</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../pandas/select_filter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Selection, Filtering and Dropping</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas/selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Selection: subset of columns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas/filtering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Filtering: subset of rows</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas/extraction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extracting values</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas/dropping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dropping</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../pandas/wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Manipulation and Wrangling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas/concat_merge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Concatenation and Merging</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas/apply.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Applying custom functions</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../plotting/basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualizing Data</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plotting/anatomy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anatomy of a Plot</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plotting/lineplots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Line Plots (Temporal Data)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plotting/scatter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Scatter Plots (<span class="math inline">\(\geq\)</span> 2 numeric variables)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../encoding/encoding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Encoding</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../encoding/types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Feature Types</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../encoding/text.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Text</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../encoding/network.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../encoding/sound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Audio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../encoding/images.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Images</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../encoding/spatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Geographic</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../encoding/time.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time Series</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../linearalgebra/vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Geometric Interpretation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linearalgebra/matrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matrices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../linearalgebra/nearestneighbor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nearest Neighbor</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../stats/stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">STATISTICS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stats/summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary Statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../stats/distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistical Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../pandas/aggregation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aggregation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas/grouping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grouping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas/pivot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pivot table</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../probability/probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PROBABILTY</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/joint_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Joint Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/conditional_prob.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conditional Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../probability/naivebayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Naive Bayes</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../calculus/calculus0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CALCULUS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../calculus/52_differential.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Differential Calculus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../calculus/41_classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Classification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../calculus/em.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Expectation Maximization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../calculus/gradientdescent.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Gradient Descent</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#conditional-probability-pa-b" id="toc-conditional-probability-pa-b" class="nav-link active" data-scroll-target="#conditional-probability-pa-b">Conditional Probability <span class="math inline">\(P(A | B)\)</span></a></li>
  <li><a href="#product-rule-pa-b" id="toc-product-rule-pa-b" class="nav-link" data-scroll-target="#product-rule-pa-b">Product Rule <span class="math inline">\(P(A, B)\)</span></a></li>
  <li><a href="#chain-rule-pa-b-c" id="toc-chain-rule-pa-b-c" class="nav-link" data-scroll-target="#chain-rule-pa-b-c">Chain Rule <span class="math inline">\(P(A, B, C)\)</span></a></li>
  <li><a href="#inclusion-exclusion-principle-pa-vee-b" id="toc-inclusion-exclusion-principle-pa-vee-b" class="nav-link" data-scroll-target="#inclusion-exclusion-principle-pa-vee-b">Inclusion-Exclusion Principle <span class="math inline">\(P(A \vee B)\)</span></a></li>
  <li><a href="#bayes-theorem-pab" id="toc-bayes-theorem-pab" class="nav-link" data-scroll-target="#bayes-theorem-pab">Bayes Theorem <span class="math inline">\(P(A|B)\)</span></a>
  <ul class="collapse">
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear Regression</a></li>
  <li><a href="#multivariate-regression" id="toc-multivariate-regression" class="nav-link" data-scroll-target="#multivariate-regression">Multivariate Regression</a></li>
  </ul></li>
  <li><a href="#interpreting-the-model" id="toc-interpreting-the-model" class="nav-link" data-scroll-target="#interpreting-the-model">Interpreting the Model</a></li>
  <li><a href="#polynomial-regression" id="toc-polynomial-regression" class="nav-link" data-scroll-target="#polynomial-regression">Polynomial Regression</a>
  <ul class="collapse">
  <li><a href="#code-example" id="toc-code-example" class="nav-link" data-scroll-target="#code-example">Code Example</a></li>
  </ul></li>
  <li><a href="#underfitting-vs.-overfitting" id="toc-underfitting-vs.-overfitting" class="nav-link" data-scroll-target="#underfitting-vs.-overfitting">Underfitting vs.&nbsp;Overfitting</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../calculus/calculus0.html">CALCULUS</a></li><li class="breadcrumb-item"><a href="../calculus/gradientdescent.html">Gradient Descent</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Gradient Descent</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="conditional-probability-pa-b" class="level2">
<h2 class="anchored" data-anchor-id="conditional-probability-pa-b">Conditional Probability <span class="math inline">\(P(A | B)\)</span></h2>
<p>Conditional probability is the probability of one event occurring given that another event has occurred.</p>
<p>The conditional probability is usually denoted by <span class="math inline">\(P(A | B)\)</span> and is defined as:</p>
<p><span class="math display">\[ P(A | B) = \frac{P(A, B)}{P(B)} \]</span></p>
<p>The denominator is the marginal probability of <span class="math inline">\(B\)</span>.</p>
<p><img width="80%" align="center" src="../assets/conditionalprob.png"></p>
<p><br></p>
<p>For example, if we are flipping two coins, the conditional probability of flipping heads in the second toss, knowing the first toss was tails is:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Possible world</th>
<th style="text-align: center;"><span class="math inline">\(\text{Coin}_1\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\text{Coin}_2\)</span></th>
<th style="text-align: center;"><span class="math inline">\(P(\omega)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\omega_1\)</span></td>
<td style="text-align: center;">H</td>
<td style="text-align: center;">H</td>
<td style="text-align: center;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\omega_2\)</span></td>
<td style="text-align: center;">H</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">0.25</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\omega_3\)</span></td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">H</td>
<td style="text-align: center;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\omega_4\)</span></td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">0.25</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[ P(\text{Coin}_2 = H | \text{Coin}_1 = T) = \frac{P(\text{Coin}_2 = H, \text{Coin}_1 = T)}{P(\text{Coin}_1 = T)} = \frac{0.25}{0.5} = 0.5 \]</span></p>
<div id="cell-3" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>merged</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
<th data-quarto-table-cell-role="th">P(C, D)</th>
<th data-quarto-table-cell-role="th">P(C)</th>
<th data-quarto-table-cell-role="th">P(D)</th>
<th data-quarto-table-cell-role="th">P(C) P(D)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>H</td>
<td>1</td>
<td>0.24</td>
<td>0.51</td>
<td>0.43</td>
<td>0.2193</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>T</td>
<td>1</td>
<td>0.19</td>
<td>0.49</td>
<td>0.43</td>
<td>0.2107</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>H</td>
<td>2</td>
<td>0.13</td>
<td>0.51</td>
<td>0.22</td>
<td>0.1122</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>T</td>
<td>2</td>
<td>0.09</td>
<td>0.49</td>
<td>0.22</td>
<td>0.1078</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>H</td>
<td>3</td>
<td>0.09</td>
<td>0.51</td>
<td>0.22</td>
<td>0.1122</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>T</td>
<td>3</td>
<td>0.13</td>
<td>0.49</td>
<td>0.22</td>
<td>0.1078</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>H</td>
<td>4</td>
<td>0.01</td>
<td>0.51</td>
<td>0.05</td>
<td>0.0255</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>T</td>
<td>4</td>
<td>0.04</td>
<td>0.49</td>
<td>0.05</td>
<td>0.0245</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>H</td>
<td>5</td>
<td>0.03</td>
<td>0.51</td>
<td>0.03</td>
<td>0.0153</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>T</td>
<td>5</td>
<td>0.00</td>
<td>0.49</td>
<td>0.03</td>
<td>0.0147</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>H</td>
<td>6</td>
<td>0.01</td>
<td>0.51</td>
<td>0.05</td>
<td>0.0255</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>T</td>
<td>6</td>
<td>0.04</td>
<td>0.49</td>
<td>0.05</td>
<td>0.0245</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-4" class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>merged[<span class="st">'P(D | C)'</span>] <span class="op">=</span> merged[<span class="st">'P(C, D)'</span>] <span class="op">/</span> merged[<span class="st">'P(C)'</span>]</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>merged[<span class="st">'P(D | C)'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0     0.470588
1     0.387755
2     0.254902
3     0.183673
4     0.176471
5     0.265306
6     0.019608
7     0.081633
8     0.058824
9     0.000000
10    0.019608
11    0.081633
Name: P(D | C), dtype: float64</code></pre>
</div>
</div>
<div id="cell-5" class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>merged[[<span class="st">'C'</span>, <span class="st">'D'</span>, <span class="st">'P(D | C)'</span>]]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>axs <span class="op">=</span> sns.catplot(data<span class="op">=</span>merged, x<span class="op">=</span><span class="st">"D"</span>, y<span class="op">=</span><span class="st">"P(D | C)"</span>, hue<span class="op">=</span><span class="st">"C"</span>, kind<span class="op">=</span><span class="st">"bar"</span>)<span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>axs.<span class="bu">set</span>(title<span class="op">=</span><span class="st">"Conditional probability distribution of D given C</span><span class="ch">\n</span><span class="st">Note that the blue bars add up to 1"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="gradientdescent_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Note that the sum of conditional probabilites, unlike joint probability, is not 1.</p>
<div id="cell-7" class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>merged[<span class="st">"P(D | C)"</span>].<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>2.0</code></pre>
</div>
</div>
<p>This is because</p>
<p><span class="math display">\[ \sum_C \sum_D P(D|C) = \sum_D P(D|C=\text{Heads}) + \sum_D P(D|C=\text{Tails}) \]</span></p>
<p>And <span class="math inline">\(\sum_D P(D|C=\text{Heads})\)</span> and <span class="math inline">\(\sum_D P(D|C=\text{Tails})\)</span> are individually probability distributions that each sum to 1, over different values of <span class="math inline">\(D\)</span>.</p>
<p>In other words, in the plot above, the blue bars add up to 1 and the orange bars add up to 1.</p>
<div id="cell-9" class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>heads <span class="op">=</span> merged[merged[<span class="st">"C"</span>] <span class="op">==</span> <span class="st">"H"</span>]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>tails <span class="op">=</span> merged[merged[<span class="st">"C"</span>] <span class="op">==</span> <span class="st">"T"</span>]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>heads[<span class="st">"P(D | C)"</span>].<span class="bu">sum</span>(), tails[<span class="st">"P(D | C)"</span>].<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(1.0, 1.0)</code></pre>
</div>
</div>
</section>
<section id="product-rule-pa-b" class="level2">
<h2 class="anchored" data-anchor-id="product-rule-pa-b">Product Rule <span class="math inline">\(P(A, B)\)</span></h2>
<p>Rearranging the definition of conditional probability, we get the product rule:</p>
<p><span class="math display">\[ P(A, B) = P(A | B) \cdot P(B) \]</span></p>
<p>Similarly, we can also write:</p>
<p><span class="math display">\[ P(A, B) = P(B | A) \cdot P(A)\]</span></p>
<p>In summary,</p>
<p><span class="math display">\[ P(A, B) = P(A | B) \cdot P(B) = P(B | A) \cdot P(A)\]</span></p>
</section>
<section id="chain-rule-pa-b-c" class="level2">
<h2 class="anchored" data-anchor-id="chain-rule-pa-b-c">Chain Rule <span class="math inline">\(P(A, B, C)\)</span></h2>
<p>The chain rule is a generalization of the product rule to more than two events.</p>
<p>$ P(A, B, C) = P(A | B, C) P(B, C) $</p>
<p><span class="math inline">\(P(A, B, C) = P(A | B, C) \cdot P(B | C) \cdot P(C)\)</span></p>
<p>since <span class="math inline">\(P(B, C) = P(B | C) \cdot P(C)\)</span> as per the product rule.</p>
<p><strong>Chain rule essentially allows expressing the joint probability of multiple random variables as a product of conditional probabilities.</strong> This is useful because conditional probabilities are often easier to estimate from data than joint probabilities.</p>
</section>
<section id="inclusion-exclusion-principle-pa-vee-b" class="level2">
<h2 class="anchored" data-anchor-id="inclusion-exclusion-principle-pa-vee-b">Inclusion-Exclusion Principle <span class="math inline">\(P(A \vee B)\)</span></h2>
<p>Inclusion-Exclusion Principle is a way of calculating the probability of two events occurring i.e.&nbsp;$ P(A=a <sub></sub> B=b) $ denoted generally as <span class="math inline">\(P(A = a \vee B = b)\)</span>.</p>
<p>It is defined as:</p>
<p><span class="math display">\[ P(A = a \vee B = b) = P(A = a) + P(B = b) - P(A = a \wedge B = b) \]</span></p>
<p><img align="center" width="80%" src="../assets/inclusion_exclusion.png"></p>
<p>For example, if we are rolling two dice, the Inclusion-Exclusion Principle can be used to calculate the probability of rolling a 1 on the first die or a 2 on the second die.</p>
<p>$P(_1=H _2=T) $</p>
<p>$ = P(_2=H) + P(_1=T) - P(_2=H ∧ _1=T)$</p>
<p>$ = 0.5 + 0.5 - 0.25 $</p>
<p>$ = 0.75$</p>
</section>
<section id="bayes-theorem-pab" class="level2">
<h2 class="anchored" data-anchor-id="bayes-theorem-pab">Bayes Theorem <span class="math inline">\(P(A|B)\)</span></h2>
<p>Bayes theorem is a way of calculating conditional probability. For example, if we are rolling two dice, Bayes theorem can be used to calculate the probability of rolling a 1 on the first die given that we rolled a 2 on the second die.</p>
<p><span class="math display">\[ P(A | B) = \frac{P(B | A) \cdot P(A)}{P(B)} \]</span></p>
<p><span class="math inline">\(P(A|B)\)</span> in the context of Bayes theorem is called the <strong>Posterior</strong> probability.</p>
<p><span class="math inline">\(P(B|A)\)</span> is called the <strong>Likelihood</strong>.</p>
<p><span class="math inline">\(P(A)\)</span> is called the <strong>Prior</strong> probability.</p>
<p><span class="math inline">\(P(B)\)</span> is called the <strong>Evidence</strong>, also known as <em>Marginal Likelihood</em>.</p>
<p><span class="math display">\[ P(\text{Posterior}) = \frac{P(\text{Likelihood})\cdot P(\text{Prior})}{P(\text{Evidence})}\]</span></p>
<center>
<img width="40%" src="https://www.analyticsvidhya.com/wp-content/uploads/2016/06/12.jpg">
</center>
<!-- 
## Expectation

Expectation is the average value of a random variable. For example, if we are rolling a die, the expectation is the average value of the number that we roll. The expectation is usually denoted by $E(X)$.

$$ E(X) = \sum_{x \in X} x \cdot P(X=x) $$

## Variance

Variance is a measure of how spread out a random variable is. For example, if we are rolling a die, the variance is a measure of how spread out the numbers that we roll are. The variance is usually denoted by $Var(X)$.

$$ Var(X) = E((X - E(X))^2) = E(X^2) - E(X)^2 $$

## Covariance

Covariance is a measure of how two random variables vary together. For example, if we are rolling two dice, the covariance is a measure of how the numbers that we roll on the two dice vary together. The covariance is usually denoted by $Cov(X, Y)$.

$$ Cov(X, Y) = E((X - E(X)) \cdot (Y - E(Y))) = E(X \cdot Y) - E(X) \cdot E(Y) $$

## Correlation

Correlation is a measure of how two random variables vary together. For example, if we are rolling two dice, the correlation is a measure of how the numbers that we roll on the two dice vary together. The correlation is usually denoted by $Corr(X, Y)$.

$$ Corr(X, Y) = \frac{Cov(X, Y)}{\sqrt{Var(X) \cdot Var(Y)}} $$ -->
<p>Bayes Theorem allows a formal method of updating prior beliefs with new evidence and is the foundation of Bayesian Statistics. We will talk more about this when we talk about Statistics.</p>
<p>In machine learning, the task is often to find <span class="math inline">\(P(Y | X_1 = x_1, X_2 = x_2, \ldots X_D = x_D)\)</span> i.e.&nbsp;the probability of an unknown Y, given some values for <span class="math inline">\(D\)</span> features (<span class="math inline">\(X_1, X_2 \ldots X_D\)</span>). Bayes theorem allows us to calculate this probability from the data.</p>
<p>Let’s assume we are interested in predicting if a person is a football player (<span class="math inline">\(Y_F=1\)</span>) or not (<span class="math inline">\(Y_F=0\)</span>), given their height (<span class="math inline">\(X_H\)</span>) and weight (<span class="math inline">\(X_W\)</span>).</p>
<p>Say, we observe a person who is 7 feet tall and weighs 200 pounds. We can use Bayes theorem to calculate the probability of this person being a football player using the following equation:</p>
<p><span class="math inline">\(P(Y | X_H = 7, X_W = 200) = \frac{P(X_H = 7, X_W = 200 | Y_F) \cdot P(Y_F)}{P(X_H = 7, X_W = 200)}\)</span></p>
<p>Note that here <span class="math inline">\(P(X_H = 7, X_W = 200 | Y_F)\)</span> is the <strong>Likelihood</strong> probability of observing someone who is 7 feet tall and weighs 200 pounds, knowing if they are a football player.</p>
<p><span class="math inline">\(P(Y_F)\)</span> is the <strong>Prior</strong> probability of a person being a football player out of the entire population.</p>
<p><span class="math inline">\(P(X_H = 7, X_W = 200)\)</span> is the probability of the <strong>Evidence</strong> i.e.&nbsp;probability of observing <em>anyone</em> who is 7 feet tall and weighs 200 pounds in the entire population.</p>
<p>Recall that all supervised learning is based on the assumption that there is a relationship between the input variables <span class="math inline">\(X\)</span> and the output variable <span class="math inline">\(y\)</span> i.e.&nbsp;</p>
<p><span class="math display">\[\textbf{y} = f(\textbf{X})\]</span></p>
<p>where <span class="math inline">\(f\)</span> is some unknown function.</p>
<p><span class="math inline">\(X\)</span> here simply is some data that we have as a <code>pd.DataFrame</code> whereas <span class="math inline">\(y\)</span> here is the target variable, one value for each observation, that we want to predict, as of type <code>pd.Series</code>.</p>
<p><img width="80%" align="center" src="https://raw.githubusercontent.com/fahadsultan/csc272/main/assets/supervised2.png"></p>
<p>The form of <strong>supervised learning</strong> we have talked about so far is <strong>classification</strong>. As discussed previously, in classification, the output variable <span class="math inline">\(y\)</span> is a <strong>discrete target variable</strong> e.g.&nbsp;sentiment <span class="math inline">\(\in\)</span> {positive, neutral or negative}, ring <span class="math inline">\(\in\)</span> {A, B} or diagnosis <span class="math inline">\(\in\)</span> {malignant, benign} etc.</p>
<p>The other type of supervised learning that we will talk about in this notebook is called <strong>Regression</strong>. In regression, the target variable is to predict a <strong>continuous target variable</strong> i.e.&nbsp;<span class="math display">\[\mathbf{y} \in \mathbb{R^N}\]</span>.</p>
<p>For example, predicting the stock price of a publicly listed company, predicting the price of a house in dollars, or predicting the average surface temperature on Earth next year are all examples of regression problems.</p>
<p>Note that the <strong>splitting of the data into training and test sets is exactly the same as in classification</strong>. The only difference is that the target variable is continuous instead of discrete.</p>
<p><img src="https://raw.githubusercontent.com/fahadsultan/csc272/main/assets/training.png" width="70%" align="center"></p>
<section id="linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="linear-regression">Linear Regression</h3>
<p>Linear Regression is the simplest solution to any regression problem.</p>
<p>In linear regression, the relationship between the input variable(s) <span class="math inline">\(X\)</span> and the output variable <span class="math inline">\(y\)</span> is assumed to be a linear.</p>
<section id="univariate-linear-regression" class="level4">
<h4 class="anchored" data-anchor-id="univariate-linear-regression">Univariate Linear Regression</h4>
<p>For simplicity, let’s assume we only have one input variable <span class="math inline">\(x\)</span> and one output variable <span class="math inline">\(y\)</span>.</p>
<p>Our goal, then is to find a linear function <span class="math inline">\(f\)</span> that maps <span class="math inline">\(x\)</span> to <span class="math inline">\(y\)</span>:</p>
<p><span class="math display">\[\mathbf{y} = f(\mathbf{x})\]</span></p>
<p>Recall that the equation for a straight line is $ f(x) = mx + b $</p>
<p>where <span class="math inline">\(m\)</span> is the slope of the line and <span class="math inline">\(b\)</span> is the y-intercept. Assuming that <span class="math inline">\(f\)</span> is a linear function, we can write:</p>
<p><span class="math display">\[\mathbf{y} = f(\mathbf{x}) = \mathbf{m} \cdot \mathbf{x} + b\]</span></p>
<p>Expanding this equation for each observation in our dataset, we get:</p>
<p><span class="math display">\[\begin{bmatrix} y_1 \\ y_2 \\ \vdots \\ y_n \end{bmatrix} = m \times \begin{bmatrix} x_1 \\ x_2 \\ \vdots \\ x_n \end{bmatrix} + b\]</span></p>
<p>where <span class="math inline">\(n\)</span> is the number of observations in our dataset.</p>
<p>The goal of linear regression is to find the values of <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span> that best fit the data.</p>
<p>The cell code below plots y vs x where <span class="math inline">\(y=mx + b\)</span> for a given value of <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span>.</p>
<div id="cell-24" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame()</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'x'</span>] <span class="op">=</span> <span class="bu">range</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'f (x)'</span>] <span class="op">=</span> m <span class="op">*</span> df[<span class="st">'x'</span>] <span class="op">+</span> b</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span><span class="st">'x'</span>, y<span class="op">=</span><span class="st">'f (x)'</span>, data<span class="op">=</span>df)<span class="op">;</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>plt.axhline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>)<span class="op">;</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>)<span class="op">;</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"f(x) = mx + b</span><span class="ch">\n\n</span><span class="st">slope (m) = </span><span class="sc">%s</span><span class="ch">\n</span><span class="st">y-intercept (b) = </span><span class="sc">%s</span><span class="st"> "</span> <span class="op">%</span> (m, b))<span class="op">;</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>plt.grid()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="gradientdescent_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now let’s load a dataset and try to find the best values of <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span> that fit the data.</p>
<p>The code below loads a dataset of Average Land Temperature on each country for each year from 1750 to 2015.</p>
<p>The temperature is in degrees Celsius. Below these temperatures are aggregated and global averages are calculated for each year.</p>
<div id="cell-27" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>data         <span class="op">=</span> pd.read_csv(<span class="st">'../data/GlobalLandTemperaturesByCountry.csv'</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'dt'</span>]   <span class="op">=</span> pd.to_datetime(data[<span class="st">'dt'</span>])</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'year'</span>] <span class="op">=</span> data[<span class="st">'dt'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.year)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'month'</span>]<span class="op">=</span> data[<span class="st">'dt'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.month)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>data         <span class="op">=</span> data.dropna()</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>data         <span class="op">=</span> data[(data[<span class="st">'year'</span>] <span class="op">&gt;=</span> <span class="dv">1900</span>) <span class="op">&amp;</span> (data[<span class="st">'month'</span>] <span class="op">==</span> <span class="dv">1</span>)]</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>avgs         <span class="op">=</span> data.groupby(<span class="st">'year'</span>).mean()[<span class="st">'AverageTemperature'</span>]</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>avgs.name    <span class="op">=</span> <span class="st">'Average Temperature (C)'</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>avgs.index, y<span class="op">=</span>avgs)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="gradientdescent_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In the code below, the data is split into training and test sets, similar to what we did in the classification examples for Naive Bayes and Nearest Neighbor models.</p>
<div id="cell-29" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>train_pct <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>train_size <span class="op">=</span> <span class="bu">int</span>(train_pct <span class="op">*</span> <span class="bu">len</span>(avgs))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>train_set <span class="op">=</span> avgs.sample(train_size, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>test_set  <span class="op">=</span> avgs[<span class="op">~</span>avgs.index.isin(train_set.index)]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> train_set.index</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> train_set</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> test_set.index</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> test_set</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>X_train, y<span class="op">=</span>y_train, label<span class="op">=</span><span class="st">'Train set'</span>)<span class="op">;</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>X_test,  y<span class="op">=</span>y_test,  label<span class="op">=</span><span class="st">'Test set'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="gradientdescent_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In the code cell below, two linear functions are plotted against the training data. Both implement the same linear function <span class="math inline">\(f(x) = mx + b\)</span> but with different values of <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span>.</p>
<div id="cell-31" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>X_train, y<span class="op">=</span>y_train,  label<span class="op">=</span><span class="st">'Train Set'</span>)<span class="op">;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="op">-</span><span class="fl">5.5</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">0.0101</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>model1 <span class="op">=</span> m <span class="op">*</span> X_train <span class="op">+</span> b</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>X_train, y<span class="op">=</span>model1.values,  label<span class="op">=</span><span class="st">'Model 1'</span>)<span class="op">;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">14.5</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>model2 <span class="op">=</span> m <span class="op">*</span> X_train <span class="op">+</span> b</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>X_train, y<span class="op">=</span>model2.values,  label<span class="op">=</span><span class="st">'Model 2'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="gradientdescent_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="errors-in-regression" class="level4">
<h4 class="anchored" data-anchor-id="errors-in-regression">Errors in Regression</h4>
<p>The evaluation of regression models is done similar to classification models. The model is trained on the training set and then evaluated on the test set.</p>
<p><img src="https://raw.githubusercontent.com/fahadsultan/csc272/main/assets/testing.png" width="70%" align="center"></p>
<p>The difference is that the training has an <strong>internal evaluation metric that is minimized to find the values of coefficients such as <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span> that best fit the training data</strong>.</p>
<p>For example, model-1 and model-2 above would yield different scores for how well they fit the training data. The model with the lowest score is the one that best fits the training data.</p>
<p>Once the model is trained, the test set is used to evaluate the model.</p>
<p>The internal evaluation metrics for linear regression during training are similar to the ones used in extrinsic evaluation on the test set.</p>
<p>The most common evaluation metrics for linear regression are as follows:</p>
<section id="residuals" class="level5">
<h5 class="anchored" data-anchor-id="residuals">Residuals</h5>
<p>Residuals are the difference between the true values of y and the predicted values of y.</p>
<p><span class="math display">\[\text{Residual}_i = y_i - \hat{y}_i\]</span></p>
<p>where <span class="math inline">\(y_i\)</span> is the <span class="math inline">\(i^{th}\)</span> true value of the target variable and <span class="math inline">\(\hat{y_i}\)</span> is the <span class="math inline">\(i^{th}\)</span> predicted value of the target variable i.e.&nbsp;<span class="math display">\[\hat{y_i} = m x_i + b\]</span></p>
<div id="cell-34" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'y'</span>] <span class="op">=</span> y_train</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'model1'</span>] <span class="op">=</span> model1</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'model2'</span>] <span class="op">=</span> model2</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>X_train, y<span class="op">=</span>y_train)<span class="op">;</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>X_train, y<span class="op">=</span>model1.values)<span class="op">;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: plt.plot((x.name, x.name), (x[<span class="st">'y'</span>], x[<span class="st">'model1'</span>]), color<span class="op">=</span><span class="st">'red'</span>, linewidth<span class="op">=</span><span class="dv">1</span>), axis<span class="op">=</span><span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Train set'</span>, <span class="st">'Model 1'</span>, <span class="st">'Residuals'</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="gradientdescent_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-35" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>X_train, y<span class="op">=</span>y_train)<span class="op">;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>X_train, y<span class="op">=</span>model2.values, color<span class="op">=</span><span class="st">'green'</span>)<span class="op">;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: plt.plot((x.name, x.name), (x[<span class="st">'y'</span>], x[<span class="st">'model2'</span>]), color<span class="op">=</span><span class="st">'red'</span>, linewidth<span class="op">=</span><span class="dv">1</span>), axis<span class="op">=</span><span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Train set'</span>, <span class="st">'Model 2'</span>, <span class="st">'Residuals'</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="gradientdescent_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="mean-absolute-error" class="level5">
<h5 class="anchored" data-anchor-id="mean-absolute-error">Mean Absolute Error</h5>
<p>The Mean Absolute Error (or MAE) is the average of the absolute differences between predictions and actual values. It gives an idea of how wrong the predictions were. The measure gives an idea of the magnitude of the error, but no idea of the direction (e.g.&nbsp;over or under predicting).</p>
<p><span class="math display">\[MAE = \frac{1}{n}\sum_{i=1}^{n}|\text{residual}_i|\]</span></p>
<p>or</p>
<p><span class="math display">\[MAE = \frac{1}{n}\sum_{i=1}^{n}|y_i - \hat{y}_i|\]</span></p>
<p>In the code cell below, two linear functions are plotted against the training data. Both implement the same linear function <span class="math inline">\(f(x) = mx + b\)</span> but with different values of <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span>.</p>
<div id="cell-38" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>X_train, y<span class="op">=</span>y_train,  label<span class="op">=</span><span class="st">'Train Set'</span>)<span class="op">;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mae(y, y_hat):</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(<span class="bu">abs</span>(y <span class="op">-</span> y_hat)) <span class="op">/</span> <span class="bu">len</span>(y)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="op">-</span><span class="fl">5.5</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">0.0101</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>model1 <span class="op">=</span> m <span class="op">*</span> X_train <span class="op">+</span> b</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>mae_model1 <span class="op">=</span> mae(y_train, model1)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>X_train, y<span class="op">=</span>model1.values,  label<span class="op">=</span><span class="vs">r'Model 1 (MAE$_{~train}$ = </span><span class="sc">%s</span><span class="vs">)'</span> <span class="op">%</span> <span class="bu">round</span>(mae_model1, <span class="dv">2</span>))<span class="op">;</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">14.5</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>model2 <span class="op">=</span> m <span class="op">*</span> X_train <span class="op">+</span> b</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>mae_model2 <span class="op">=</span> mae(y_train, model2)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>X_train, y<span class="op">=</span>model2.values,  label<span class="op">=</span><span class="vs">r'Model 2 (MAE$_{~train}$ = </span><span class="sc">%s</span><span class="vs">)'</span> <span class="op">%</span> <span class="bu">round</span>(mae_model2, <span class="dv">2</span>))<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="gradientdescent_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In order to find the best values of <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span>, we need to define an evaluation metric that we want to minimize.</p>
<p>The code cell below plots model 1 and model 2 against the <strong>test set</strong> and also calculates the MAE for each model.</p>
<div id="cell-40" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>X_train, y<span class="op">=</span>y_train,  label<span class="op">=</span><span class="st">'Test Set'</span>)<span class="op">;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mae(y, y_hat):</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(<span class="bu">abs</span>(y <span class="op">-</span> y_hat)) <span class="op">/</span> <span class="bu">len</span>(y)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="op">-</span><span class="fl">5.5</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">0.0101</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>model1 <span class="op">=</span> m <span class="op">*</span> X_test <span class="op">+</span> b</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>mae_model1 <span class="op">=</span> mae(y_test, model1)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span>X_test, y<span class="op">=</span>model1.values, linewidth<span class="op">=</span><span class="dv">3</span>,<span class="op">\</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>             label<span class="op">=</span><span class="vs">r'Model 1 (MAE$_{~test}$ = </span><span class="sc">%s</span><span class="vs">)'</span> <span class="op">%</span> <span class="bu">round</span>(mae_model1, <span class="dv">2</span>), color<span class="op">=</span><span class="st">'orange'</span>)<span class="op">;</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">14.5</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>model2 <span class="op">=</span> m <span class="op">*</span> X_test <span class="op">+</span> b</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>mae_model2 <span class="op">=</span> mae(y_test, model2)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span>X_test, y<span class="op">=</span>model2.values, linewidth<span class="op">=</span><span class="dv">3</span>,  <span class="op">\</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>             label<span class="op">=</span><span class="vs">r'Model 2 (MAE$_{~test}$ = </span><span class="sc">%s</span><span class="vs">)'</span> <span class="op">%</span> <span class="bu">round</span>(mae_model2, <span class="dv">2</span>), color<span class="op">=</span><span class="st">'green'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="gradientdescent_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="mean-squared-error" class="level5">
<h5 class="anchored" data-anchor-id="mean-squared-error">Mean Squared Error</h5>
<p>The Mean Squared Error (or MSE) is much like the mean absolute error in that it provides a gross idea of the magnitude of error.</p>
<p><span class="math display">\[MSE = \frac{1}{n}\sum_{i=1}^{n}(\text{Residual}_i)^2\]</span></p>
<p>or</p>
<p><span class="math display">\[MSE = \frac{1}{n}\sum_{i=1}^{n}(y_i - \hat{y}_i)^2\]</span></p>
<div id="cell-42" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mse(y, y_hat):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>((y <span class="op">-</span> y_hat)<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> <span class="bu">len</span>(y)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>mse1 <span class="op">=</span> mse(df[<span class="st">'y'</span>], df[<span class="st">'model1'</span>])</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>mse2 <span class="op">=</span> mse(df[<span class="st">'y'</span>], df[<span class="st">'model2'</span>])</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" MSE model 1: "</span>, <span class="bu">round</span>(mse1, <span class="dv">2</span>), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, <span class="st">"MSE model 2: "</span>, <span class="bu">round</span>(mse2, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> MSE model 1:  0.17 
 MSE model 2:  0.37</code></pre>
</div>
</div>
</section>
<section id="root-mean-squared-error" class="level5">
<h5 class="anchored" data-anchor-id="root-mean-squared-error">Root Mean Squared Error</h5>
<p>Taking the square root of the mean squared error converts the units back to the original units of the output variable and can be meaningful for description and presentation. This is called the Root Mean Squared Error (or RMSE).</p>
<p><span class="math display">\[RMSE = \sqrt{\frac{1}{n}\sum_{i=1}^{n}(\text{Residual}_i)^2}\]</span></p>
<p>or</p>
<p><span class="math display">\[RMSE = \sqrt{\frac{1}{n}\sum_{i=1}^{n}(y_i - \hat{y}_i)^2}\]</span></p>
<div id="cell-44" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rmse(y, y_hat):</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="bu">sum</span>((y <span class="op">-</span> y_hat)<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> <span class="bu">len</span>(y))<span class="op">**</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>mse1 <span class="op">=</span> rmse(df[<span class="st">'y'</span>], df[<span class="st">'model1'</span>])</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>mse2 <span class="op">=</span> rmse(df[<span class="st">'y'</span>], df[<span class="st">'model2'</span>])</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" RMSE model 1: "</span>, <span class="bu">round</span>(mse1, <span class="dv">2</span>), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, <span class="st">"RMSE model 2: "</span>, <span class="bu">round</span>(mse2, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> RMSE model 1:  0.41 
 RMSE model 2:  0.61</code></pre>
</div>
</div>
</section>
<section id="textr2" class="level5">
<h5 class="anchored" data-anchor-id="textr2"><span class="math inline">\(\text{R}^2\)</span></h5>
<p>The <span class="math inline">\(\text{R}^2\)</span> (or R Squared) metric provides an indication of the goodness of fit of a set of predictions to the actual values. In statistical literature, this measure is called the coefficient of determination. This is a value between 0 and 1 for no-fit and perfect fit respectively.</p>
<p><span class="math display">\[\text{R}^2 = 1 - \frac{\sum_{i=1}^{n}(y_i - \hat{y}_i)^2}{\sum_{i=1}^{n}(y_i - \bar{y})^2}\]</span></p>
<p>where <span class="math inline">\(\bar{y} = \frac{1}{n}\sum_{i=1}^{n}y_i\)</span> is the mean of the observed data.</p>
<div id="cell-46" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> r2(y, y_hat):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span> <span class="op">-</span> <span class="bu">sum</span>((y <span class="op">-</span> y_hat)<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> <span class="bu">sum</span>((y <span class="op">-</span> y.mean())<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>r2_1 <span class="op">=</span> r2(df[<span class="st">'y'</span>], df[<span class="st">'model1'</span>])</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>r2_2 <span class="op">=</span> r2(df[<span class="st">'y'</span>], df[<span class="st">'model2'</span>])</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" R2 model 1: "</span>, <span class="bu">round</span>(r2_1, <span class="dv">2</span>), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, <span class="st">"R2 model 2: "</span>, <span class="bu">round</span>(r2_2, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> R2 model 1:  0.36 
 R2 model 2:  -0.4</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="multivariate-regression" class="level3">
<h3 class="anchored" data-anchor-id="multivariate-regression">Multivariate Regression</h3>
<p>Multiple linear regression (MLR), also known simply as multiple regression, uses multiple (&gt; 1) input variables (<span class="math inline">\(X\)</span>) to predict the outcome of a target variable (<span class="math inline">\(y \in \mathbb{R}\)</span>) by fitting a linear equation to observed data.</p>
<p><span class="math display">\[\mathbf{y} = f(\mathbf{X})\]</span></p>
<p>Here <span class="math inline">\(f\)</span> is a linear function of the form:</p>
<p><span class="math display">\[f(\mathbf{X}) = \mathbf{X}\mathbf{m} + b\]</span></p>
<p>where <span class="math inline">\(X\)</span> is a matrix of <span class="math inline">\(N\)</span> observations and <span class="math inline">\(D\)</span> features and <span class="math inline">\(y\)</span> is a vector of <span class="math inline">\(N\)</span> observations.</p>
<p><span class="math display">\[X = \begin{bmatrix}
x_{11} &amp; x_{12} &amp; \dots &amp; x_{1D} \\
x_{21} &amp; x_{22} &amp; \dots &amp; x_{2D} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
x_{N1} &amp; x_{N2} &amp; \dots &amp; x_{ND} \\
\end{bmatrix}\]</span></p>
<p><span class="math display">\[y = \begin{bmatrix}
y_1 \\
y_2 \\
\vdots \\
y_N \\
\end{bmatrix}\]</span></p>
<p>where <span class="math inline">\(\mathbf{m}\)</span> is a vector of <span class="math inline">\(D\)</span> slopes and <span class="math inline">\(b\)</span> is the y-intercept. i.e.&nbsp;</p>
<p><span class="math display">\[\mathbf{m} = \begin{bmatrix}
m_1 \\
m_2 \\
\vdots \\
m_D \\
\end{bmatrix}\]</span></p>
<p>Putting it all together, we get:</p>
<p><span class="math display">\[\begin{bmatrix}
y_1 \\
y_2 \\
\vdots \\
y_N \\
\end{bmatrix} = \begin{bmatrix}
x_{11} &amp; x_{12} &amp; \dots &amp; x_{1D} \\
x_{21} &amp; x_{22} &amp; \dots &amp; x_{2D} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
x_{N1} &amp; x_{N2} &amp; \dots &amp; x_{ND} \\
\end{bmatrix} \begin{bmatrix}
m_1 \\
m_2 \\
\vdots \\
m_D \\
\end{bmatrix} + b\]</span></p>
<p>The goal of multiple linear regression is to find the values of <span class="math inline">\(m_1, m_2, \dots, m_D\)</span> and <span class="math inline">\(b\)</span> that best fit the data.</p>
<p><br></p>
<p>Now let’s load a dataset and try to find the best values of <span class="math inline">\(m_1\)</span> and <span class="math inline">\(b\)</span> that fit the data.</p>
<!-- The code cell below uses data from the [Boston Housing Dataset](https://www.cs.toronto.edu/~delve/data/boston/bostonDetail.html) to predict the median value of owner-occupied homes in Boston in the mid-1970s given the following input variables:

- CRIM: per capita crime rate by town.
- ZN: proportion of residential land zoned for lots over 25,000 sq.ft.
- INDUS: proportion of non-retail business acres per town.
- CHAS: Charles River dummy variable (= 1 if tract bounds river; 0 otherwise).
- NOX: nitric oxides concentration (parts per 10 million).
- RM: average number of rooms per dwelling.
- AGE: proportion of owner-occupied units built prior to 1940.
- DIS: weighted mean of distances to five Boston employment centres.
- RAD: index of accessibility to radial highways.
- TAX: full-value property-tax rate per \$10,000.
- PTRATIO: pupil-teacher ratio by town.

The target variable is:

- MEDV: median value of owner-occupied homes in \$1000s. -->
<p>The code below uses data from California Housing Dataset to predict the median house value in California districts given the following input variables:</p>
<ol type="1">
<li>MedInc: Median income in block.</li>
<li>HouseAge: Median house age within a block (measured in years).</li>
<li>AveRooms: Average number of rooms within a block of houses.</li>
<li>AveBedrms: Average number of bedrooms within a block of houses.</li>
<li>Population: Total number of people residing within a block.</li>
<li>AveOccup: Average number of people occupying each house within a block.</li>
<li>Longitude: A measure of how far west a house is; a higher value is farther west.</li>
<li>Latitude: A measure of how far north a house is; a higher value is farther north.</li>
</ol>
<p>The target variable is:</p>
<ul>
<li>Median house value for households within a block (measured in US Dollars).</li>
</ul>
<div id="cell-49" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span>  datasets</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>california <span class="op">=</span> datasets.fetch_california_housing()</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pd.DataFrame(california.data, columns<span class="op">=</span>california.feature_names)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> pd.Series(california.target, name<span class="op">=</span><span class="st">'Price'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-50" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>X.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>(20640, 8)</code></pre>
</div>
</div>
<div id="cell-51" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>X.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">MedInc</th>
<th data-quarto-table-cell-role="th">HouseAge</th>
<th data-quarto-table-cell-role="th">AveRooms</th>
<th data-quarto-table-cell-role="th">AveBedrms</th>
<th data-quarto-table-cell-role="th">Population</th>
<th data-quarto-table-cell-role="th">AveOccup</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Longitude</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.3252</td>
<td>41.0</td>
<td>6.984127</td>
<td>1.023810</td>
<td>322.0</td>
<td>2.555556</td>
<td>37.88</td>
<td>-122.23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>8.3014</td>
<td>21.0</td>
<td>6.238137</td>
<td>0.971880</td>
<td>2401.0</td>
<td>2.109842</td>
<td>37.86</td>
<td>-122.22</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>7.2574</td>
<td>52.0</td>
<td>8.288136</td>
<td>1.073446</td>
<td>496.0</td>
<td>2.802260</td>
<td>37.85</td>
<td>-122.24</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>5.6431</td>
<td>52.0</td>
<td>5.817352</td>
<td>1.073059</td>
<td>558.0</td>
<td>2.547945</td>
<td>37.85</td>
<td>-122.25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3.8462</td>
<td>52.0</td>
<td>6.281853</td>
<td>1.081081</td>
<td>565.0</td>
<td>2.181467</td>
<td>37.85</td>
<td>-122.25</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-52" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>y.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>0    4.526
1    3.585
2    3.521
3    3.413
4    3.422
Name: Price, dtype: float64</code></pre>
</div>
</div>
<div id="cell-53" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_absolute_error, mean_squared_error, r2_score</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>model.fit(X_train, y_train)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>y_hat <span class="op">=</span> model.predict(X_test)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"MAE: "</span>,  <span class="bu">round</span>(mean_absolute_error(y_test, y_hat), <span class="dv">2</span>))</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"MSE: "</span>,  <span class="bu">round</span>(mean_squared_error(y_test, y_hat), <span class="dv">2</span>))</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"RMSE:"</span>,  <span class="bu">round</span>((mean_squared_error(y_test, y_hat))<span class="op">**</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>), <span class="dv">2</span>))</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"R2:  "</span>,  <span class="bu">round</span>(r2_score(y_test, y_hat), <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MAE:  0.53
MSE:  0.51
RMSE: 0.71
R2:   0.62</code></pre>
</div>
</div>
<p>Choosing between these metrics depends on the specific context of the problem:</p>
<ul>
<li>Use MAE if you want a metric that’s easy to understand and not influenced much by outliers.</li>
<li>Use RMSE when larger errors should be penalized more heavily and a metric in the same unit as the target variable is desired.</li>
<li>Use MSE when optimizing models since it emphasizes larger errors, making it useful in minimizing those errors during training</li>
</ul>
<div id="cell-55" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.DataFrame()</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>results[<span class="st">'Actual'</span>] <span class="op">=</span> y_test</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>results[<span class="st">'Prediction'</span>] <span class="op">=</span> y_hat</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">3</span>))</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">'Actual'</span>, y<span class="op">=</span><span class="st">'Prediction'</span>, data<span class="op">=</span>results)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="gradientdescent_files/figure-html/cell-23-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="interpreting-the-model" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-the-model">Interpreting the Model</h2>
<p>The model we have trained is a linear function of the form:</p>
<p><span class="math display">\[\text{MedianHouseValue} = (m_1 \times \text{MedInc}) + (m_2 \times \text{HouseAge}) + \\(m_3 \times \text{AveRooms}) + (m_4 \times \text{AveBedrms}) + \\(m_5 \times \text{Population}) + (m_6 \times \text{AveOccup}) + \\(m_7 \times \text{Longitude}) + (m_8 \times \text{Latitude}) + b\]</span></p>
<p>where <span class="math inline">\(m_1, m_2, \dots, m_8\)</span> are the slopes and <span class="math inline">\(b\)</span> is the y-intercept.</p>
<p>The slopes <span class="math inline">\(m_1, m_2, \dots, m_8\)</span> tell us how much the target variable changes when the corresponding input variable changes by 1 unit.</p>
<p>The code cell below plots the slopes in decreasing order of magnitude.</p>
<div id="cell-57" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>weights <span class="op">=</span> pd.Series(model.coef_, index<span class="op">=</span>X.columns)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>weights <span class="op">=</span> weights.sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span>weights.index, y<span class="op">=</span>weights.values, palette<span class="op">=</span><span class="st">'bwr'</span>)<span class="op">;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="gradientdescent_files/figure-html/cell-24-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The plot indicates that <code>AveBedrms</code>, <code>MedInc</code> and <code>AveRooms</code> have the <strong>highest positive relationship</strong> with the Price of the house whereas <code>AveRooms</code>, <code>Latitude</code>, <code>Longitude</code> have the <strong>strongest negative relationship</strong> with the target variable Price of the house.</p>
</section>
<section id="polynomial-regression" class="level2">
<h2 class="anchored" data-anchor-id="polynomial-regression">Polynomial Regression</h2>
<p>Polynomial functions are functions that have the form:</p>
<p><span class="math display">\[f(x) = b + m_1 x + m_2 x^2 + m_3 x^3 + ... + m_n x^n\]</span></p>
<p>where <span class="math inline">\(b, m_1, m_2, m_3, ..., w_n\)</span> are the coefficients of the polynomial function and <span class="math inline">\(n\)</span> is called the <strong>degree of the polynomial</strong>. In other words, the degree of a polynomial function is the <strong>highest power of the variable</strong> in the polynomial function.</p>
<p>Note that the linear function <span class="math inline">\(f(x) = mx + b\)</span> is a special case of the polynomial function. More specifically, a linear function is a polynomial function of degree 1.</p>
<p>Polynomial functions of degree 2 or higher are called <strong>non-linear functions</strong>. As the degree of the polynomial function increases, the function becomes more flexible and can fit more complex patterns in the data.</p>
<p>If we have only one input variable <span class="math inline">\(x\)</span> to predict the output variable <span class="math inline">\(y\)</span>, then the polynomial function becomes:</p>
<p><span class="math display">\[y = f(x) = b + m_1 x + m_2 x^2 + m_3 x^3 + ... + m_n x^n\]</span></p>
<p>In matrix notation, polynomial regression can be written as:</p>
<p><span class="math display">\[f(\mathbf{x}) = \mathbf{X}\mathbf{m} + b\]</span></p>
<p>where <span class="math inline">\(\mathbf{X}\)</span> is a matrix of <span class="math inline">\(N\)</span> observations and each feature is raised to a power from 1 to <span class="math inline">\(D\)</span>.</p>
<p><span class="math display">\[\begin{bmatrix}
y_1 \\
y_2 \\
\vdots \\
y_N \\
\end{bmatrix}  = \begin{bmatrix}
x_1 &amp; x_1^2 &amp; x_1^3 &amp; \dots &amp; x_1^D \\
x_2 &amp; x_2^2 &amp; x_2^3 &amp; \dots &amp; x_2^D \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
x_N &amp; x_N^2 &amp; x_N^3 &amp; \dots &amp; x_N^D \\
\end{bmatrix} \cdot \begin{bmatrix}
m_1 \\
m_2 \\
\vdots \\
m_D \\
\end{bmatrix} + b\]</span></p>
<section id="code-example" class="level3">
<h3 class="anchored" data-anchor-id="code-example">Code Example</h3>
<p>Let’s implement polynomial regression on the Average Land Temperature dataset.</p>
<div id="cell-62" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>data         <span class="op">=</span> pd.read_csv(<span class="st">'../data/GlobalLandTemperaturesByCountry.csv'</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'dt'</span>]   <span class="op">=</span> pd.to_datetime(data[<span class="st">'dt'</span>])</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'year'</span>] <span class="op">=</span> data[<span class="st">'dt'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.year)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>data[<span class="st">'month'</span>]<span class="op">=</span> data[<span class="st">'dt'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.month)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>data         <span class="op">=</span> data.dropna()</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>data         <span class="op">=</span> data[(data[<span class="st">'year'</span>] <span class="op">&gt;=</span> <span class="dv">1900</span>) <span class="op">&amp;</span> (data[<span class="st">'month'</span>] <span class="op">==</span> <span class="dv">1</span>)]</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>avgs         <span class="op">=</span> data.groupby(<span class="st">'year'</span>).mean()[<span class="st">'AverageTemperature'</span>]</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>avgs.name    <span class="op">=</span> <span class="st">'Average Temperature (C)'</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span>avgs.index, y<span class="op">=</span>avgs)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="gradientdescent_files/figure-html/cell-25-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-63" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> avgs.index.values.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> avgs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-64" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>annual_means <span class="op">=</span> data.groupby(<span class="st">'year'</span>).mean()[<span class="st">'AverageTemperature'</span>][::<span class="dv">10</span>]</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> annual_means.index.values.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> annual_means.values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-65" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>train_set <span class="op">=</span> avgs.sample(<span class="bu">int</span>(<span class="fl">0.8</span><span class="op">*</span><span class="bu">len</span>(avgs)), random_state<span class="op">=</span><span class="dv">42</span>).sort_index()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>test_set  <span class="op">=</span> avgs.drop(train_set.index).sort_index()</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>X_train   <span class="op">=</span> train_set.index.values.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>y_train   <span class="op">=</span> train_set.values.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>X_test    <span class="op">=</span> test_set.index.values.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>y_test    <span class="op">=</span> test_set.values.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Implementing polynomial regression in <code>sklearn</code> is similar to linear regression but with one additional step. We need to transform the input data into a polynomial matrix before fitting the model. In <code>sklearn</code>, this is done using the <code>PolynomialFeatures</code> class.</p>
<p>The code cell below implements polynomial regression of degrees 1, 2 and 5 on the Average Land Temperature dataset.</p>
<div id="cell-67" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> PolynomialFeatures</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> make_pipeline</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>plt.scatter(X_train, y_train, label<span class="op">=</span><span class="st">'X'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)<span class="op">;</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'orange'</span>, <span class="st">'green'</span>, <span class="st">'red'</span>]</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, degree <span class="kw">in</span> <span class="bu">enumerate</span>([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>]):</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create polynomial features for X_train and X_test</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    poly         <span class="op">=</span> PolynomialFeatures(degree<span class="op">=</span>degree)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    X_train_poly <span class="op">=</span> poly.fit_transform(X_train)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    X_test_poly  <span class="op">=</span> poly.fit_transform(X_test)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit a linear regression model to the training data</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>    model        <span class="op">=</span> LinearRegression()</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>    model.fit(X_train_poly, y_train)</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Predict y values for X_test</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>    y_pred       <span class="op">=</span> model.predict(X_test_poly)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the predictions</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_test, y_pred, linewidth<span class="op">=</span><span class="dv">3</span>, label<span class="op">=</span><span class="st">'Degree = </span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> degree, alpha<span class="op">=</span><span class="fl">0.7</span>, color<span class="op">=</span>colors[i])<span class="op">;</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>plt.legend()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="gradientdescent_files/figure-html/cell-29-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Note that with increasing degree, the polynomial function can fit more complex patterns non-linear trends in the data.</p>
</section>
</section>
<section id="underfitting-vs.-overfitting" class="level2">
<h2 class="anchored" data-anchor-id="underfitting-vs.-overfitting">Underfitting vs.&nbsp;Overfitting</h2>
<p>This example demonstrates the problems of underfitting and overfitting and how we can use linear regression with polynomial features to approximate nonlinear functions.</p>
<p>The plot shows the function that we want to approximate, which is a part of the cosine function. In addition, the samples from the real function and the approximations of different models are displayed. The models have polynomial features of different degrees. We can see that a linear function (polynomial with degree 1) is not sufficient to fit the training samples. This is called <strong>underfitting</strong>.</p>
<p>A polynomial of degree 4 approximates the true function almost perfectly. However, for higher degrees the model will overfit the training data, i.e.&nbsp;it learns the noise of the training data. This is called <strong>overfitting</strong>. We evaluate quantitatively overfitting / underfitting by using cross-validation.</p>
<p>We calculate the mean squared error (MSE) on the validation set, the higher, the less likely the model generalizes correctly from the training data.</p>
<div id="cell-70" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> PolynomialFeatures</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> true_fun(X):</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.cos(<span class="fl">1.5</span> <span class="op">*</span> np.pi <span class="op">*</span> X)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>degrees <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">15</span>]</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.sort(np.random.rand(n_samples))</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> true_fun(X) <span class="op">+</span> np.random.randn(n_samples) <span class="op">*</span> <span class="fl">0.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-71" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.scatterplot(x<span class="op">=</span>X, y<span class="op">=</span>y, label<span class="op">=</span><span class="st">'Samples'</span>)<span class="op">;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'X'</span>, ylabel<span class="op">=</span><span class="st">'y'</span>, title <span class="op">=</span> <span class="vs">r'$y = cos(1.5 \pi  x) + \epsilon$'</span>)<span class="op">;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span>X, y<span class="op">=</span>true_fun(X), label<span class="op">=</span><span class="st">'True function'</span>, color<span class="op">=</span><span class="st">'blue'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="gradientdescent_files/figure-html/cell-31-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-72" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">5</span>))</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(degrees)):</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> plt.subplot(<span class="dv">1</span>, <span class="bu">len</span>(degrees), i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    plt.setp(ax, xticks<span class="op">=</span>(), yticks<span class="op">=</span>())</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    polynomial_features <span class="op">=</span> PolynomialFeatures(degree<span class="op">=</span>degrees[i], include_bias<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    linear_regression <span class="op">=</span> LinearRegression()</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    pipeline <span class="op">=</span> Pipeline(</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>        [</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>            (<span class="st">"polynomial_features"</span>, polynomial_features),</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>            (<span class="st">"linear_regression"</span>, linear_regression),</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    pipeline.fit(X[:, np.newaxis], y)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Evaluate the models using crossvalidation</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    scores <span class="op">=</span> cross_val_score(</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>        pipeline, X[:, np.newaxis], y, scoring<span class="op">=</span><span class="st">"neg_mean_squared_error"</span>, cv<span class="op">=</span><span class="dv">10</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>    X_test <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>    plt.scatter(X, y, edgecolor<span class="op">=</span><span class="st">"b"</span>, s<span class="op">=</span><span class="dv">20</span>, label<span class="op">=</span><span class="st">"Samples"</span>)</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_test, true_fun(X_test), label<span class="op">=</span><span class="st">"True function"</span>)</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_test, pipeline.predict(X_test[:, np.newaxis]), label<span class="op">=</span><span class="st">"Model </span><span class="sc">%s</span><span class="st"> (degree = </span><span class="sc">%s</span><span class="st">)"</span> <span class="op">%</span> (i<span class="op">+</span><span class="dv">1</span>, degrees[i]))</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">"x"</span>)</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"y"</span>)</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>    plt.xlim((<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>    plt.ylim((<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>    plt.legend(loc<span class="op">=</span><span class="st">"best"</span>)</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>    plt.title(</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MSE = </span><span class="sc">{:.2}</span><span class="st"> +/- </span><span class="sc">{:.2}</span><span class="st">"</span>.<span class="bu">format</span>(</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>            <span class="bu">round</span>(<span class="op">-</span>scores.mean(), <span class="dv">2</span>), <span class="bu">round</span>(scores.std(), <span class="dv">2</span>)</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">"Polynomial Regression with increasing degrees, leading to overfitting"</span>, fontsize<span class="op">=</span><span class="dv">14</span>)<span class="op">;</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="gradientdescent_files/figure-html/cell-32-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Ideally, you want to strike a balance between underfitting (high training error, high testing error) and overfitting (low training error, high testing error) by picking a model complexity (number of parameters) that generalizes well to unseen data.</p>
<p><img align="center" width="70%" src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/02/Screenshot-2020-02-06-at-11.09.13.png"></p>
<p>Note that model complexity here refers to the number of parameters in the model. For example, univariate linear regression model has 2 parameters (slope and y-intercept) whereas a polynomial regression model of degree 2 has 3 parameters (slope, y-intercept and coefficient of <span class="math inline">\(x^2\)</span>).</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>